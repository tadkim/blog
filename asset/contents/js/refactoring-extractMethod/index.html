<table id="meta">
	<thead><th>160406</th><th>Javascript</th><th>김태경</th></thead>
	<tbody>
	<tr><td></td><td></td><td></td></tr>
	<tr><td></td><td></td><td></td></tr>
	<tr><td></td><td></td><td></td></tr>
	</tbody>
</table>
<p><strong>9&#8211;3 메서드 추출(Extract Method)</strong></p>

<blockquote>
<p>“그룹으로 함께 묶을 수 있는 코드 조각이 있으면, 코드의 목적이 잘 드러나도록 메서드의 이름을 지어 별도의 메서드로 추출한다.” - 마틴 파울러의 저서 “리팩토링”의 메서드 추출(Extract Method)에서.<sup><a href="#fn:1" id="fnref:1" title="see footnote" class="footnote">1</a></sup></p>
</blockquote>

<p><strong>메서드 추출이란</strong>?</p>

<p>개발을 진행하다 보면 함수의 몸체가 커지는 경우가 비일비재하다. 읽기 좋은 코드를 좋아하는 개발자라면 <strong>목적별로 코드를 나누고 이름을 지어 메서드나 함수를 만들어 옮길 것이다. 이런 리팩터링 기법을 <code>메서드 추출</code>이라고 한다.</strong></p>

<p><strong>[9&#8211;3&#8211;1] <code>Extract &gt; Organization.js</code> 파일 열기</strong></p>

<figure>
<img src="http://whiteleo.azurewebsites.net/colony/markdown/refactoring/refactoring_extract_method_01.png" alt="Webstorm, Refactoring - Extract Method : Organization.js 파일구조 " title=" Webstorm, Refactoring - Extract method " />
<figcaption>Webstorm, Refactoring - Extract Method : Organization.js 파일구조 </figcaption>
</figure>

<p><code>Organization</code> 메서드는 다음의 3가지 작업을 수행하고 있다.</p>

<ol>
<li>AJAX로 조직 리스트 데이터를 요청하는 일</li>
<li>반환된 데이터를 순회해 객체화 하는 일</li>
<li>객체화된 조직을 순회해 관계를 조합하는 일.</li>
</ol>

<p><strong>상황설정</strong></p>

<hr />

<p><code>Organization</code> 메서드가 수행하고 있는 3가지 작업을 각각의 메서드로 추출하기.</p>

<p><strong>리팩터링 - Extract Method 방법</strong></p>

<hr />

<ul>
<li>추출할 코드 영역을 드래그한다.</li>
<li>오른쪽 클릭 후 <code>Refactor &gt; Extract Method</code> 클릭.</li>
</ul>

<figure>
<img src="http://whiteleo.azurewebsites.net/colony/markdown/refactoring/refactoring_extract_method_02.png" alt="Webstorm, Refactoring - Extract Method : Choose Destination Scope " title=" Webstorm, Refactoring - Extract method " />
<figcaption>Webstorm, Refactoring - Extract Method : Choose Destination Scope </figcaption>
</figure>

<p><code>Choose Destination Scope</code> 윈도우 옵션 설명</p>

<ul>
<li><code>global</code> : 추출 함수를 전역에 만드는 것</li>
<li><code>object assigned to Organizations.prototype</code> : Organization.prototype의 메서드로 추출함수를 만드는 것</li>
<li><code>function execute</code> : execute 메서드 내부로 추출 함수를 만드는 것</li>
<li><code>function starting with</code> : 소속된 익명 함수 내부에 추출 함수를 만드는 것</li>
</ul>

<p><strong>이 예제에서는 <code>assigned to Organization.prototype</code>을 클릭한다.</strong>.</p>

<figure>
<img src="http://whiteleo.azurewebsites.net/colony/markdown/refactoring/refactoring_extract_method_03.png" alt="Webstorm, Refactoring - Extract Method : Extract Function " title=" Webstorm, Refactoring - Extract method " />
<figcaption>Webstorm, Refactoring - Extract Method : Extract Function </figcaption>
</figure>

<p><code>Extract Function 윈도우</code> 창이 열리면 메서드 이름을 <code>_makeOrganizations</code> 라고 입력하고 <code>OK</code>를 누른다.</p>

<figure>
<img src="http://whiteleo.azurewebsites.net/colony/markdown/refactoring/refactoring_extract_method_04.png" alt="Webstorm, Refactoring - Extract Method : 실행 전후비교 " title=" Webstorm, Refactoring - Extract method " />
<figcaption>Webstorm, Refactoring - Extract Method : 실행 전후비교 </figcaption>
</figure>

<p><strong>기능 적용후 변동사항</strong></p>

<p>반환된 데이터를 순회해 객체화하는 코드를 <code>_makeOrganizations</code> 메서드로 추출했다.</p>

<p><code>객체화된 조직을 순회해 관계를 조합하는 코드</code>도 같은 방법으로 추출해본다.</p>

<figure>
<img src="http://whiteleo.azurewebsites.net/colony/markdown/refactoring/refactoring_extract_method_05.png" alt="Webstorm, Refactoring - Extract Method : 실행 전후비교 2 " title=" Webstorm, Refactoring - Extract method " />
<figcaption>Webstorm, Refactoring - Extract Method : 실행 전후비교 2 </figcaption>
</figure>

<p>객체화된 조직을 순회해 관계를 조합하는 코드도 같은 방법으로 추출했다. 메서드의 이름은 <code>_composeOrganizations</code>로 한다.</p>

<p><strong>웹스톰 <code>Extract Method</code> 리팩터의 자동 파라미터 생성 기능에 대하여</strong></p>

<p>웹스톰의 <code>Extract Method</code> 리팩터는 자동으로 의존하는 변수를 파라미터로 설정한다. <code>htOrganizations</code>는 전달하는 게 맞지만 실행 문맥이 달라 클로저를 이용해 문맥을 전달하는 용도로 사용한 <code>self</code>라는 변수는 <code>_composeOrganizations</code> 메서드로 옮기는 게 맞으므로 코드를 정리한다. <code>Change Signature</code> 리팩터를 사용하면 조금 더 빨리 수정 할 수 있을 것이다.</p>

<p>해당 코드를 다음 사진에서 확인할 수 있다.</p>

<figure>
<img src="http://whiteleo.azurewebsites.net/colony/markdown/refactoring/refactoring_extract_method_06.png" alt="Webstorm, Refactoring - Extract Method : self 변수 " title=" Webstorm, Refactoring - Extract method " />
<figcaption>Webstorm, Refactoring - Extract Method : self 변수 </figcaption>
</figure>

<p>self 변수를 왜, 어떤 메커니즘에서 정리하고 있는지에 대해서는 자바스크립트 언어에 대한 이해를 조금 더 한 후에 다시 살펴보기로 하자.</p>

<p>웹스톰 리팩터 기능으로 돌아와서, 3가지 작업 중 마지막 AJAX 코드를 메서드로 추출해보도록한다. 방법은 동일하며, <code>_requestList</code>라는 메서드 명으로 추출한다.</p>

<figure>
<img src="http://whiteleo.azurewebsites.net/colony/markdown/refactoring/refactoring_extract_method_07.png" alt="Webstorm, Refactoring - Extract Method : _requsetList수정 " title=" Webstorm, Refactoring - Extract method " />
<figcaption>Webstorm, Refactoring - Extract Method : <code>_requsetList</code>수정 </figcaption>
</figure>

<p>앞에서 사용하고 있는 <code>then</code>은 jQuery의 <code>프로미스 메서드</code>다. 익명 함수 내부에 있는 코드는 프로미스 메서드로 구현할 때 익명 함수를 사용할 필요가 없다. 프로미스의 원리를 이용해 더 읽기 쉽게 아래와 같이 작성한다.</p>

<p><strong>Extract Method - Promise Method 개념 활용</strong></p>

<figure>
<img src="http://whiteleo.azurewebsites.net/colony/markdown/refactoring/refactoring_extract_method_08.png" alt="Webstorm, Refactoring - Extract Method : _requsetList수정 " title=" Webstorm, Refactoring - Extract method " />
<figcaption>Webstorm, Refactoring - Extract Method : <code>_requsetList</code>수정 </figcaption>
</figure>

<blockquote>
<p><strong>프로미스</strong>란, E 언어<sup><a href="#fn:2" id="fnref:2" title="see footnote" class="footnote">2</a></sup>에서 처음 고안된 프로미스는 병렬로 실행되는 연산 결과를 전달하고 취득하기 위해 처음 고안된 패턴이며 자바, 스칼라, 파이선 등 많은 언어에 존재한다. </p>

<p><strong>자바스크립트에서의 프로미스는 병렬이 아닌 비동기 처리의 최종 결과를 조금 더 효율적으로 전달하기 위해 고안된 패턴이다</strong>. 프로미스 객체를 데이터 전송 추상화 컨테이너라고도 하는데 이유는 메서드나 함수는 프로미스 객체를 반환할 뿐이며 실제 데이터와 그 데이터를 가공하거나 검증하는 로직 등은 프로미스에서 추상화하고 있기 때문이다.</p>
</blockquote>

<div class="footnotes">
<hr />
<ol>

<li id="fn:1">
<p>주우영 지음, “프런트엔드 개발 시작하기”, 2015, 위키북스, 116쪽. (재인용) <a href="#fnref:1" title="return to article" class="reversefootnote">&#8617;&#xFE0E;</a></p>
</li>

<li id="fn:2">
<p>http://erights.org/elib/distrib/pipeline.html <a href="#fnref:2" title="return to article" class="reversefootnote">&#8617;&#xFE0E;</a></p>
</li>

</ol>
</div>
